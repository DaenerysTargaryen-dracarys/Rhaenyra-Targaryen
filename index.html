<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #e6f2ff;
        background-image: radial-gradient(#b3d9ff 15%, transparent 16%),
                          radial-gradient(#b3d9ff 15%, transparent 16%);
        background-size: 40px 40px;
        background-position: 0 0, 20px 20px;
        color: #333;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 8px 8px 0 #333, 15px 15px 0 #ffcc00;
        border: 4px solid #333;
        position: relative;
        overflow: hidden;
    }
    .container:before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border: 3px dashed #ff6600;
        border-radius: 20px;
        pointer-events: none;
        z-index: -1;
    }
    h1 {
        text-align: center;
        font-size: 36px;
        margin-bottom: 25px;
        color: #ff3300;
        text-shadow: 3px 3px 0 #ffcc00, 6px 6px 0 rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 30px;
        background: white;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
    }
    h1:after {
        content: "!!!";
        position: absolute;
        top: -20px;
        right: -20px;
        background: #ffcc00;
        color: #ff3300;
        font-size: 24px;
        padding: 5px 10px;
        border-radius: 50%;
        border: 3px solid #333;
        transform: rotate(15deg);
        animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
        from { transform: rotate(15deg) scale(1); }
        to { transform: rotate(15deg) scale(1.1); }
    }
    .file-section {
        text-align: center;
        margin: 25px 0;
        padding: 25px;
        border: 4px dashed #ff6600;
        border-radius: 15px;
        background-color: #fff9e6;
        position: relative;
        min-height: 120px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    .file-section:before {
        content: "üìÅ";
        position: absolute;
        top: -20px;
        left: 20px;
        font-size: 40px;
        background: white;
        padding: 5px;
        border: 3px solid #333;
        border-radius: 10px;
        transform: rotate(-10deg);
    }
    .file-input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        width: 100%;
        max-width: 400px;
    }
    .file-label {
        font-weight: bold;
        font-size: 18px;
        color: #333;
        background: #ffcc00;
        padding: 8px 15px;
        border-radius: 8px;
        border: 2px solid #333;
        box-shadow: 3px 3px 0 #333;
        cursor: pointer;
        transition: all 0.2s;
    }
    .file-label:hover {
        transform: translateY(-2px);
        box-shadow: 4px 4px 0 #333;
    }
    input[type="file"] {
        display: none;
    }
    .file-name {
        font-size: 16px;
        color: #666;
        background: white;
        padding: 8px 15px;
        border-radius: 8px;
        border: 2px solid #3399ff;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 12px 25px;
        border: 3px solid #333;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        transition: all 0.2s;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 4px 4px 0 #333;
    }
    .btn:hover {
        transform: translateY(-3px);
        box-shadow: 6px 6px 0 #333;
    }
    .btn:active {
        transform: translateY(1px);
        box-shadow: 2px 2px 0 #333;
    }
    .btn-primary { 
        background-color: #3399ff; 
        color: white; 
    }
    .btn-primary:hover { 
        background-color: #0077e6; 
    }
    .btn-success { 
        background-color: #33cc33; 
        color: white; 
    }
    .btn-success:hover { 
        background-color: #29a329; 
    }
    .btn-warning { 
        background-color: #ffcc00; 
        color: #333; 
    }
    .btn-warning:hover { 
        background-color: #e6b800; 
    }
    .btn:disabled { 
        background-color: #cccccc; 
        color: #999;
        cursor: not-allowed; 
        box-shadow: 2px 2px 0 #999;
        border-color: #999;
    }
    .btn:disabled:hover {
        transform: none;
        box-shadow: 2px 2px 0 #999;
    }
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-top: 25px;
        border: 4px solid #333;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    th, td {
        border-bottom: 3px solid #333;
        border-right: 3px solid #333;
        padding: 12px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
        font-size: 18px;
        text-transform: uppercase;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    th:last-child, td:last-child {
        border-right: none;
    }
    tr:last-child td {
        border-bottom: none;
    }
    tr:nth-child(even) { 
        background-color: #fff0e6; 
    }
    tr:nth-child(odd) { 
        background-color: white; 
    }
    .copy-btn {
        background-color: #33cc99;
        color: white;
        border: 2px solid #333;
        padding: 8px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        box-shadow: 2px 2px 0 #333;
        transition: all 0.2s;
    }
    .copy-btn:hover { 
        background-color: #29a37a; 
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 #333;
    }
    .copy-btn:active {
        transform: translateY(1px);
        box-shadow: 1px 1px 0 #333;
    }
    .copy-btn.copied {
        background-color: #ff3333 !important;
        cursor: not-allowed;
        animation: wiggle 0.5s;
    }
    .copy-btn:disabled {
        background-color: #999999 !important;
        color: #666;
        cursor: not-allowed;
        box-shadow: 1px 1px 0 #666;
        border-color: #666;
        transform: none;
    }
    @keyframes wiggle {
        0%, 100% { transform: rotate(0); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 25px 0;
        padding: 15px;
        border-radius: 10px;
        border: 3px solid;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 3px 3px 0 #333;
    }
    .status.success { 
        background-color: #ccffcc; 
        color: #006600; 
        border-color: #33cc33;
    }
    .status.error { 
        background-color: #ffcccc; 
        color: #cc0000; 
        border-color: #ff3333;
    }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    .comic-dots {
        position: absolute;
        width: 20px;
        height: 20px;
        background: #ffcc00;
        border: 3px solid #333;
        border-radius: 50%;
    }
    .dot-1 { top: 20px; left: 20px; }
    .dot-2 { top: 20px; right: 20px; }
    .dot-3 { bottom: 20px; left: 20px; }
    .dot-4 { bottom: 20px; right: 20px; }
    .speech-bubble {
        position: absolute;
        bottom: -40px;
        right: 30px;
        background: white;
        border: 3px solid #333;
        border-radius: 20px;
        padding: 10px 15px;
        font-weight: bold;
        box-shadow: 3px 3px 0 #333;
        transform: rotate(-5deg);
        animation: float 3s infinite ease-in-out;
    }
    .speech-bubble:after {
        content: "";
        position: absolute;
        bottom: -15px;
        right: 30px;
        border-width: 15px 10px 0;
        border-style: solid;
        border-color: white transparent;
        display: block;
        width: 0;
    }
    .speech-bubble:before {
        content: "";
        position: absolute;
        bottom: -18px;
        right: 29px;
        border-width: 16px 11px 0;
        border-style: solid;
        border-color: #333 transparent;
        display: block;
        width: 0;
    }
    @keyframes float {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .container {
            padding: 15px;
        }
        h1 {
            font-size: 28px;
            padding: 8px 20px;
        }
        .file-section {
            padding: 20px 15px;
        }
        .button-group {
            flex-direction: column;
            align-items: center;
        }
        .btn {
            width: 100%;
            max-width: 300px;
        }
        table {
            font-size: 14px;
        }
        th, td {
            padding: 8px;
        }
    }
</style>
</head>
<body>
<div class="container">
    <div class="comic-dots dot-1"></div>
    <div class="comic-dots dot-2"></div>
    <div class="comic-dots dot-3"></div>
    <div class="comic-dots dot-4"></div>
    
    <h1>Survey Link Generator</h1>
    
    <div class="file-section">
        <div class="file-input-container">
            <label for="fileInput" class="file-label">üìÅ CHOOSE EXCEL FILE</label>
            <input type="file" id="fileInput" accept=".xlsx, .xls">
            <div class="file-name" id="fileName">No file chosen</div>
        </div>
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
        <div class="speech-bubble">Click me!</div>
    </div>
    
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link,
                        copied: false // Track if this link has been copied
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" data-index="${currentData.length - 1}">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            // Add event listeners to all copy buttons
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    copyIndividualLink(index, this);
                });
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(index, button) {
    const linkData = currentData[index];
    
    // If already copied, do nothing
    if (linkData.copied) {
        return;
    }
    
    const link = linkData.link;
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = link;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark as copied and disable the button
            linkData.copied = true;
            button.textContent = 'Copied!';
            button.classList.add('copied');
            button.disabled = true;
            
            showStatus('Link copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy link', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy link', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = links;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark all links as copied and disable all copy buttons
            currentData.forEach((item, index) => {
                item.copied = true;
            });
            
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                button.disabled = true;
            });
            
            showStatus('All links copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy all links', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy all links', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    Get App
<meta name='viewport' content='width=device-width, initial-scale=1'/>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #121212;
        color: #f0f0f0;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: #1e1e1e;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    h1 {
        text-align: center;
        font-size: 24px;
        margin-bottom: 20px;
        color: #ffcc00;
    }
    .file-section {
        text-align: center;
        margin: 20px 0;
        padding: 20px;
        border: 2px dashed #444;
        border-radius: 8px;
        background-color: #222;
    }
    input[type="file"] {
        margin-top: 10px;
    }
    .button-group {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
    }
    .btn-primary { background-color: #007bff; color: white; }
    .btn-primary:hover { background-color: #0056b3; }
    .btn-success { background-color: #28a745; color: white; }
    .btn-success:hover { background-color: #218838; }
    .btn-warning { background-color: #ffc107; color: #212529; }
    .btn-warning:hover { background-color: #e0a800; }
    .btn:disabled { background-color: #6c757d; cursor: not-allowed; opacity: 0.6; }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    th, td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
    }
    tr:nth-child(even) { background-color: #1a1a1a; }
    .copy-btn {
        background-color: #17a2b8;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
    }
    .copy-btn:hover { background-color: #138496; }
    .copy-btn.copied {
        background-color: red !important;
        cursor: not-allowed;
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 20px 0;
        padding: 10px;
        border-radius: 5px;
    }
    .status.success { background-color: #155724; color: #d4edda; border: 1px solid #28a745; }
    .status.error { background-color: #721c24; color: #f8d7da; border: 1px solid #dc3545; }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 1px solid #333;
        border-radius: 5px;
    }

    /* üî• EPIC ACTION ANIMATIONS */
    
    /* Screen shake effect */
    .screen-shake {
        animation: screenShake 0.5s ease-in-out;
    }
    @keyframes screenShake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px) rotate(0.5deg); }
        20%, 40%, 60%, 80% { transform: translateX(5px) rotate(-0.5deg); }
    }
    
    /* Explosive row entry */
    .animate-row {
        animation: explosiveEntry 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        opacity: 0;
        transform: translateX(200px) rotateY(-90deg) scale(0.3);
    }
    @keyframes explosiveEntry {
        0% {
            opacity: 0;
            transform: translateX(200px) rotateY(-90deg) scale(0.3);
        }
        60% {
            opacity: 1;
            transform: translateX(-10px) rotateY(10deg) scale(1.1);
        }
        100% {
            opacity: 1;
            transform: translateX(0) rotateY(0deg) scale(1);
        }
    }

    /* Nuclear explosion effect */
    .nuclear-explosion {
        position: absolute;
        width: 150px;
        height: 150px;
        background: radial-gradient(
            circle,
            rgba(255, 255, 0, 1) 0%,
            rgba(255, 165, 0, 0.9) 20%,
            rgba(255, 69, 0, 0.7) 40%,
            rgba(255, 0, 0, 0.5) 60%,
            rgba(0, 0, 0, 0) 100%
        );
        border-radius: 50%;
        pointer-events: none;
        animation: nuclearBlast 0.8s ease-out forwards;
        z-index: 1000;
    }
    @keyframes nuclearBlast {
        0% {
            transform: scale(0) rotate(0deg);
            opacity: 1;
            filter: blur(0px);
        }
        50% {
            transform: scale(2) rotate(180deg);
            opacity: 0.8;
            filter: blur(2px);
        }
        100% {
            transform: scale(4) rotate(360deg);
            opacity: 0;
            filter: blur(10px);
        }
    }

    /* Lightning effect */
    .lightning-strike {
        position: absolute;
        width: 3px;
        height: 100px;
        background: linear-gradient(to bottom, 
            rgba(255, 255, 255, 1) 0%,
            rgba(0, 191, 255, 0.8) 50%,
            rgba(255, 255, 255, 0) 100%
        );
        pointer-events: none;
        animation: lightningFlash 0.3s ease-in-out;
        z-index: 999;
    }
    @keyframes lightningFlash {
        0%, 100% { opacity: 0; transform: scaleY(0); }
        10%, 90% { opacity: 1; transform: scaleY(1) translateY(-50px); }
        50% { opacity: 1; transform: scaleY(1.5) translateY(-75px); }
    }

    /* Particle burst */
    .particle-burst {
        position: absolute;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        pointer-events: none;
        animation: particleExplode 1s ease-out forwards;
    }
    .particle-burst.fire { background: linear-gradient(45deg, #ff6b35, #f7931e); }
    .particle-burst.electric { background: linear-gradient(45deg, #00d4ff, #ffffff); box-shadow: 0 0 10px #00d4ff; }
    .particle-burst.magic { background: linear-gradient(45deg, #ff00ff, #8000ff); box-shadow: 0 0 8px #ff00ff; }
    
    @keyframes particleExplode {
        0% {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }
        100% {
            opacity: 0;
            transform: scale(0.2) rotate(720deg);
        }
    }

    /* Shockwave effect */
    .shockwave {
        position: absolute;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(0, 191, 255, 0.8);
        border-radius: 50%;
        pointer-events: none;
        animation: shockwaveExpand 0.6s ease-out forwards;
    }
    @keyframes shockwaveExpand {
        0% {
            transform: scale(0);
            opacity: 1;
        }
        100% {
            transform: scale(15);
            opacity: 0;
        }
    }

    /* Matrix rain effect */
    .matrix-rain {
        position: absolute;
        color: #00ff41;
        font-family: 'Courier New', monospace;
        font-size: 12px;
        pointer-events: none;
        animation: matrixFall 2s linear forwards;
        text-shadow: 0 0 5px #00ff41;
    }
    @keyframes matrixFall {
        0% {
            opacity: 1;
            transform: translateY(-20px);
        }
        100% {
            opacity: 0;
            transform: translateY(100px);
        }
    }

    /* Button transformation */
    .copy-btn {
        background-color: #17a2b8;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }
    
    .copy-btn:hover { 
        background-color: #138496; 
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(23, 162, 184, 0.5);
    }
    
    .copy-btn.copied {
        background-color: #ff4757 !important;
        cursor: not-allowed;
        animation: buttonDestroy 0.8s ease-out forwards;
    }
    
    @keyframes buttonDestroy {
        0% { transform: scale(1) rotate(0deg); }
        25% { transform: scale(1.2) rotate(-5deg); }
        50% { transform: scale(0.9) rotate(5deg); }
        75% { transform: scale(1.1) rotate(-3deg); }
        100% { transform: scale(1) rotate(0deg); filter: grayscale(0.5); }
    }

    /* Holographic scan line */
    .scan-line {
        position: absolute;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(0, 255, 255, 0.8) 50%, 
            transparent 100%
        );
        pointer-events: none;
        animation: scanMove 0.5s ease-in-out;
        z-index: 998;
    }
    @keyframes scanMove {
        0% { transform: translateY(-50px); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(50px); opacity: 0; }
    }

    /* Energy sphere */
    .energy-sphere {
        position: absolute;
        width: 40px;
        height: 40px;
        background: radial-gradient(circle, 
            rgba(0, 255, 255, 1) 0%,
            rgba(0, 255, 255, 0.5) 50%,
            rgba(0, 255, 255, 0) 100%
        );
        border-radius: 50%;
        pointer-events: none;
        animation: energyPulse 0.4s ease-out forwards;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }
    @keyframes energyPulse {
        0% {
            transform: scale(0) rotate(0deg);
            opacity: 1;
        }
        100% {
            transform: scale(3) rotate(360deg);
            opacity: 0;
        }
    }
</style>
</head>
<body>
<div class="container">
    <h1>Survey Link Generator</h1>
    <div class="file-section">
        <h3>Upload Excel File</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls">
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    <div id="status" class="status" style="display: none;"></div>
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
    </div>
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// üî• EPIC ACTION EFFECTS

// Nuclear explosion effect
function createNuclearExplosion(button, event) {
    const explosion = document.createElement('div');
    explosion.className = 'nuclear-explosion';
    const rect = button.getBoundingClientRect();
    explosion.style.left = (event.clientX - rect.left - 75) + 'px';
    explosion.style.top = (event.clientY - rect.top - 75) + 'px';
    button.appendChild(explosion);
    
    // Screen shake
    document.body.classList.add('screen-shake');
    setTimeout(() => document.body.classList.remove('screen-shake'), 500);
    
    setTimeout(() => explosion.remove(), 800);
}

// Lightning strike effect
function createLightningStrike(button) {
    for (let i = 0; i < 5; i++) {
        const lightning = document.createElement('div');
        lightning.className = 'lightning-strike';
        lightning.style.left = Math.random() * button.offsetWidth + 'px';
        lightning.style.top = '-50px';
        lightning.style.animationDelay = i * 0.1 + 's';
        button.appendChild(lightning);
        
        setTimeout(() => lightning.remove(), 300);
    }
}

// Particle burst explosion
function createParticleBurst(button, event) {
    const particleTypes = ['fire', 'electric', 'magic'];
    const rect = button.getBoundingClientRect();
    
    for (let i = 0; i < 25; i++) {
        const particle = document.createElement('div');
        particle.className = `particle-burst ${particleTypes[Math.floor(Math.random() * particleTypes.length)]}`;
        
        const angle = (Math.PI * 2 * i) / 25;
        const velocity = Math.random() * 100 + 50;
        const startX = event.clientX - rect.left;
        const startY = event.clientY - rect.top;
        
        particle.style.left = startX + 'px';
        particle.style.top = startY + 'px';
        particle.style.setProperty('--end-x', Math.cos(angle) * velocity + 'px');
        particle.style.setProperty('--end-y', Math.sin(angle) * velocity + 'px');
        
        // Custom animation for each particle
        particle.style.animation = `particleExplode 1s ease-out forwards`;
        particle.style.transform = `translate(${Math.cos(angle) * velocity}px, ${Math.sin(angle) * velocity}px)`;
        
        button.appendChild(particle);
        setTimeout(() => particle.remove(), 1000);
    }
}

// Shockwave effect
function createShockwave(button, event) {
    for (let i = 0; i < 3; i++) {
        const shockwave = document.createElement('div');
        shockwave.className = 'shockwave';
        const rect = button.getBoundingClientRect();
        shockwave.style.left = (event.clientX - rect.left - 10) + 'px';
        shockwave.style.top = (event.clientY - rect.top - 10) + 'px';
        shockwave.style.animationDelay = i * 0.2 + 's';
        button.appendChild(shockwave);
        
        setTimeout(() => shockwave.remove(), 600);
    }
}

// Matrix rain effect
function createMatrixRain(button) {
    const matrixChars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';
    
    for (let i = 0; i < 15; i++) {
        const char = document.createElement('div');
        char.className = 'matrix-rain';
        char.textContent = matrixChars[Math.floor(Math.random() * matrixChars.length)];
        char.style.left = Math.random() * button.offsetWidth + 'px';
        char.style.top = '-20px';
        char.style.animationDelay = Math.random() * 0.5 + 's';
        button.appendChild(char);
        
        setTimeout(() => char.remove(), 2000);
    }
}

// Holographic scan effect
function createHolographicScan(button) {
    const scanLine = document.createElement('div');
    scanLine.className = 'scan-line';
    scanLine.style.left = '0';
    scanLine.style.top = '0';
    button.appendChild(scanLine);
    
    setTimeout(() => scanLine.remove(), 500);
}

// Energy sphere effect
function createEnergySphere(button, event) {
    const sphere = document.createElement('div');
    sphere.className = 'energy-sphere';
    const rect = button.getBoundingClientRect();
    sphere.style.left = (event.clientX - rect.left - 20) + 'px';
    sphere.style.top = (event.clientY - rect.top - 20) + 'px';
    button.appendChild(sphere);
    
    setTimeout(() => sphere.remove(), 400);
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.classList.add('animate-row');
                    tr.style.animationDelay = `${index * 0.1}s`;
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" onclick="copyIndividualLink('${link}', this, event)">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// üî• MEGA EPIC ENHANCED
Change the ui simple don't change anything
Survey Link Generator - Simplified UI
I'll keep all the functionality but simplify the UI while maintaining the dark theme and core features.

html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #121212;
        color: #f0f0f0;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: #1e1e1e;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    h1 {
        text-align: center;
        font-size: 24px;
        margin-bottom: 20px;
        color: #ffcc00;
    }
    .file-section {
        text-align: center;
        margin: 20px 0;
        padding: 20px;
        border: 1px solid #444;
        border-radius: 8px;
        background-color: #222;
    }
    input[type="file"] {
        margin-top: 10px;
    }
    .button-group {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin: 20px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
    }
    .btn-primary { background-color: #007bff; color: white; }
    .btn-primary:hover { background-color: #0056b3; }
    .btn-success { background-color: #28a745; color: white; }
    .btn-success:hover { background-color: #218838; }
    .btn-warning { background-color: #ffc107; color: #212529; }
    .btn-warning:hover { background-color: #e0a800; }
    .btn:disabled { background-color: #6c757d; cursor: not-allowed; opacity: 0.6; }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    th, td {
        border: 1px solid #333;
        padding: 8px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
    }
    tr:nth-child(even) { background-color: #1a1a1a; }
    .copy-btn {
        background-color: #17a2b8;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
    }
    .copy-btn:hover { background-color: #138496; }
    .copy-btn.copied {
        background-color: red !important;
        cursor: not-allowed;
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 20px 0;
        padding: 10px;
        border-radius: 5px;
    }
    .status.success { background-color: #155724; color: #d4edda; border: 1px solid #28a745; }
    .status.error { background-color: #721c24; color: #f8d7da; border: 1px solid #dc3545; }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 1px solid #333;
        border-radius: 5px;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Survey Link Generator</h1>
    <div class="file-section">
        <h3>Upload Excel File</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls">
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    <div id="status" class="status" style="display: none;"></div>
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
    </div>
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" onclick="copyIndividualLink('${link}', this)">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(link, button) {
    navigator.clipboard.writeText(link).then(() => {
        button.textContent = 'Copied!';
        button.classList.add('copied');
        setTimeout(() => {
            button.textContent = 'Copy';
            button.classList.remove('copied');
        }, 2000);
    });
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    navigator.clipboard.writeText(links).then(() => {
        showStatus('All links copied to clipboard!', 'success');
    });
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "survey_links.csv");
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showStatus('CSV exported successfully!', 'success');
}

// Clear all data
function clearData() {
    currentData = [];
    document.querySelector('#linkTable tbody').innerHTML = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('copyAllBtn').disabled = true;
    document.getElementById('exportBtn').disabled = true;
    document.getElementById('generateBtn').disabled = true;
    document.getElementById('status').style.display = 'none';
}

// Show status message
function showStatus(message, type) {
    const statusEl = document.getElementById('status');
    statusEl.textContent = message;
    statusEl.className = `status ${type}`;
    statusEl.style.display = 'block';
}

// Enable generate button when file is selected
document.getElementById('fileInput').addEventListener('change', function() {
    document.getElementById('generateBtn').disabled = !this.files.length;
});
</script>
</body>
</html>
Key Changes Made:
Removed all complex animations (nuclear explosions, lightning, particles, etc.)

Simplified styling:

Reduced shadow intensity

Removed complex border effects

Simplified button hover effects

Removed animation delays and transitions

Kept all functionality:

File upload and processing

Link generation

Copy individual links

Copy all links

Export to CSV

Clear data

Maintained the dark theme and color scheme

Preserved the table structure and data display

The UI is now much cleaner and simpler while maintaining all the core functionality of the original application.

Change the ui in comic theme note keep all same only ui in comic theme
Survey Link Generator - Comic Theme
I'll transform the UI into a fun comic book theme while keeping all functionality exactly the same.

html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #e6f2ff;
        background-image: radial-gradient(#b3d9ff 15%, transparent 16%),
                          radial-gradient(#b3d9ff 15%, transparent 16%);
        background-size: 40px 40px;
        background-position: 0 0, 20px 20px;
        color: #333;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 8px 8px 0 #333, 15px 15px 0 #ffcc00;
        border: 4px solid #333;
        position: relative;
        overflow: hidden;
    }
    .container:before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border: 3px dashed #ff6600;
        border-radius: 20px;
        pointer-events: none;
        z-index: -1;
    }
    h1 {
        text-align: center;
        font-size: 36px;
        margin-bottom: 25px;
        color: #ff3300;
        text-shadow: 3px 3px 0 #ffcc00, 6px 6px 0 rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 30px;
        background: white;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
    }
    h1:after {
        content: "!!!";
        position: absolute;
        top: -20px;
        right: -20px;
        background: #ffcc00;
        color: #ff3300;
        font-size: 24px;
        padding: 5px 10px;
        border-radius: 50%;
        border: 3px solid #333;
        transform: rotate(15deg);
        animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
        from { transform: rotate(15deg) scale(1); }
        to { transform: rotate(15deg) scale(1.1); }
    }
    .file-section {
        text-align: center;
        margin: 25px 0;
        padding: 25px;
        border: 4px dashed #ff6600;
        border-radius: 15px;
        background-color: #fff9e6;
        position: relative;
    }
    .file-section:before {
        content: "üìÅ";
        position: absolute;
        top: -20px;
        left: 20px;
        font-size: 40px;
        background: white;
        padding: 5px;
        border: 3px solid #333;
        border-radius: 10px;
        transform: rotate(-10deg);
    }
    input[type="file"] {
        margin-top: 15px;
        padding: 10px;
        border: 3px solid #3399ff;
        border-radius: 10px;
        background: white;
        font-family: 'Comic Sans MS', sans-serif;
        font-size: 16px;
        cursor: pointer;
    }
    .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 12px 25px;
        border: 3px solid #333;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        transition: all 0.2s;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 4px 4px 0 #333;
    }
    .btn:hover {
        transform: translateY(-3px);
        box-shadow: 6px 6px 0 #333;
    }
    .btn:active {
        transform: translateY(1px);
        box-shadow: 2px 2px 0 #333;
    }
    .btn-primary { 
        background-color: #3399ff; 
        color: white; 
    }
    .btn-primary:hover { 
        background-color: #0077e6; 
    }
    .btn-success { 
        background-color: #33cc33; 
        color: white; 
    }
    .btn-success:hover { 
        background-color: #29a329; 
    }
    .btn-warning { 
        background-color: #ffcc00; 
        color: #333; 
    }
    .btn-warning:hover { 
        background-color: #e6b800; 
    }
    .btn:disabled { 
        background-color: #cccccc; 
        color: #999;
        cursor: not-allowed; 
        box-shadow: 2px 2px 0 #999;
        border-color: #999;
    }
    .btn:disabled:hover {
        transform: none;
        box-shadow: 2px 2px 0 #999;
    }
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-top: 25px;
        border: 4px solid #333;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    th, td {
        border-bottom: 3px solid #333;
        border-right: 3px solid #333;
        padding: 12px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
        font-size: 18px;
        text-transform: uppercase;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    th:last-child, td:last-child {
        border-right: none;
    }
    tr:last-child td {
        border-bottom: none;
    }
    tr:nth-child(even) { 
        background-color: #fff0e6; 
    }
    tr:nth-child(odd) { 
        background-color: white; 
    }
    .copy-btn {
        background-color: #33cc99;
        color: white;
        border: 2px solid #333;
        padding: 8px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        box-shadow: 2px 2px 0 #333;
        transition: all 0.2s;
    }
    .copy-btn:hover { 
        background-color: #29a37a; 
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 #333;
    }
    .copy-btn:active {
        transform: translateY(1px);
        box-shadow: 1px 1px 0 #333;
    }
    .copy-btn.copied {
        background-color: #ff3333 !important;
        cursor: not-allowed;
        animation: wiggle 0.5s;
    }
    @keyframes wiggle {
        0%, 100% { transform: rotate(0); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 25px 0;
        padding: 15px;
        border-radius: 10px;
        border: 3px solid;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 3px 3px 0 #333;
    }
    .status.success { 
        background-color: #ccffcc; 
        color: #006600; 
        border-color: #33cc33;
    }
    .status.error { 
        background-color: #ffcccc; 
        color: #cc0000; 
        border-color: #ff3333;
    }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    .comic-dots {
        position: absolute;
        width: 20px;
        height: 20px;
        background: #ffcc00;
        border: 3px solid #333;
        border-radius: 50%;
    }
    .dot-1 { top: 20px; left: 20px; }
    .dot-2 { top: 20px; right: 20px; }
    .dot-3 { bottom: 20px; left: 20px; }
    .dot-4 { bottom: 20px; right: 20px; }
    .speech-bubble {
        position: absolute;
        bottom: -40px;
        right: 30px;
        background: white;
        border: 3px solid #333;
        border-radius: 20px;
        padding: 10px 15px;
        font-weight: bold;
        box-shadow: 3px 3px 0 #333;
        transform: rotate(-5deg);
        animation: float 3s infinite ease-in-out;
    }
    .speech-bubble:after {
        content: "";
        position: absolute;
        bottom: -15px;
        right: 30px;
        border-width: 15px 10px 0;
        border-style: solid;
        border-color: white transparent;
        display: block;
        width: 0;
    }
    .speech-bubble:before {
        content: "";
        position: absolute;
        bottom: -18px;
        right: 29px;
        border-width: 16px 11px 0;
        border-style: solid;
        border-color: #333 transparent;
        display: block;
        width: 0;
    }
    @keyframes float {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }
</style>
</head>
<body>
<div class="container">
    <div class="comic-dots dot-1"></div>
    <div class="comic-dots dot-2"></div>
    <div class="comic-dots dot-3"></div>
    <div class="comic-dots dot-4"></div>
    
    <h1>Survey Link Generator</h1>
    
    <div class="file-section">
        <h3>Upload Excel File</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls">
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
        <div class="speech-bubble">Click me!</div>
    </div>
    
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" onclick="copyIndividualLink('${link}', this)">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(link, button) {
    navigator.clipboard.writeText(link).then(() => {
        button.textContent = 'Copied!';
        button.classList.add('copied');
        setTimeout(() => {
            button.textContent = 'Copy';
            button.classList.remove('copied');
        }, 2000);
    });
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    navigator.clipboard.writeText(links).then(() => {
        showStatus('All links copied to clipboard!', 'success');
    });
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "survey_links.csv");
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showStatus('CSV exported successfully!', 'success');
}

// Clear all data
function clearData() {
    currentData = [];
    document.querySelector('#linkTable tbody').innerHTML = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('copyAllBtn').disabled = true;
    document.getElementById('exportBtn').disabled = true;
    document.getElementById('generateBtn').disabled = true;
    document.getElementById('status').style.display = 'none';
}

// Show status message
function showStatus(message, type) {
    const statusEl = document.getElementById('status');
    statusEl.textContent = message;
    statusEl.className = `status ${type}`;
    statusEl.style.display = 'block';
}

// Enable generate button when file is selected
document.getElementById('fileInput').addEventListener('change', function() {
    document.getElementById('generateBtn').disabled = !this.files.length;
});
</script>
</body>
</html>
Key Comic Theme Changes:
Comic-style typography - Using Comic Sans MS and other rounded fonts

Bold, vibrant colors - Bright primary colors with high contrast

Comic elements:

Speech bubbles

Bold borders with shadows

Animated elements (bouncing, floating)

Comic dots in corners

Exaggerated text effects with shadows

Playful interactions:

Buttons with comic-style shadows and hover effects

Wiggle animation when copying

Bouncing exclamation mark in title

Visual hierarchy:

Thick borders and shadows to create depth

Bright section backgrounds

Cartoon-style file upload area

All functionality remains exactly the same - only the visual design has been transformed into a comic book style!

Error unable to copy
Survey Link Generator - Comic Theme (Fixed Copy Issue)
I've fixed the copy functionality and maintained the comic theme. The issue was with special characters in the generated links.

html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #e6f2ff;
        background-image: radial-gradient(#b3d9ff 15%, transparent 16%),
                          radial-gradient(#b3d9ff 15%, transparent 16%);
        background-size: 40px 40px;
        background-position: 0 0, 20px 20px;
        color: #333;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 8px 8px 0 #333, 15px 15px 0 #ffcc00;
        border: 4px solid #333;
        position: relative;
        overflow: hidden;
    }
    .container:before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border: 3px dashed #ff6600;
        border-radius: 20px;
        pointer-events: none;
        z-index: -1;
    }
    h1 {
        text-align: center;
        font-size: 36px;
        margin-bottom: 25px;
        color: #ff3300;
        text-shadow: 3px 3px 0 #ffcc00, 6px 6px 0 rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 30px;
        background: white;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
    }
    h1:after {
        content: "!!!";
        position: absolute;
        top: -20px;
        right: -20px;
        background: #ffcc00;
        color: #ff3300;
        font-size: 24px;
        padding: 5px 10px;
        border-radius: 50%;
        border: 3px solid #333;
        transform: rotate(15deg);
        animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
        from { transform: rotate(15deg) scale(1); }
        to { transform: rotate(15deg) scale(1.1); }
    }
    .file-section {
        text-align: center;
        margin: 25px 0;
        padding: 25px;
        border: 4px dashed #ff6600;
        border-radius: 15px;
        background-color: #fff9e6;
        position: relative;
    }
    .file-section:before {
        content: "üìÅ";
        position: absolute;
        top: -20px;
        left: 20px;
        font-size: 40px;
        background: white;
        padding: 5px;
        border: 3px solid #333;
        border-radius: 10px;
        transform: rotate(-10deg);
    }
    input[type="file"] {
        margin-top: 15px;
        padding: 10px;
        border: 3px solid #3399ff;
        border-radius: 10px;
        background: white;
        font-family: 'Comic Sans MS', sans-serif;
        font-size: 16px;
        cursor: pointer;
    }
    .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 12px 25px;
        border: 3px solid #333;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        transition: all 0.2s;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 4px 4px 0 #333;
    }
    .btn:hover {
        transform: translateY(-3px);
        box-shadow: 6px 6px 0 #333;
    }
    .btn:active {
        transform: translateY(1px);
        box-shadow: 2px 2px 0 #333;
    }
    .btn-primary { 
        background-color: #3399ff; 
        color: white; 
    }
    .btn-primary:hover { 
        background-color: #0077e6; 
    }
    .btn-success { 
        background-color: #33cc33; 
        color: white; 
    }
    .btn-success:hover { 
        background-color: #29a329; 
    }
    .btn-warning { 
        background-color: #ffcc00; 
        color: #333; 
    }
    .btn-warning:hover { 
        background-color: #e6b800; 
    }
    .btn:disabled { 
        background-color: #cccccc; 
        color: #999;
        cursor: not-allowed; 
        box-shadow: 2px 2px 0 #999;
        border-color: #999;
    }
    .btn:disabled:hover {
        transform: none;
        box-shadow: 2px 2px 0 #999;
    }
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-top: 25px;
        border: 4px solid #333;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    th, td {
        border-bottom: 3px solid #333;
        border-right: 3px solid #333;
        padding: 12px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
        font-size: 18px;
        text-transform: uppercase;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    th:last-child, td:last-child {
        border-right: none;
    }
    tr:last-child td {
        border-bottom: none;
    }
    tr:nth-child(even) { 
        background-color: #fff0e6; 
    }
    tr:nth-child(odd) { 
        background-color: white; 
    }
    .copy-btn {
        background-color: #33cc99;
        color: white;
        border: 2px solid #333;
        padding: 8px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        box-shadow: 2px 2px 0 #333;
        transition: all 0.2s;
    }
    .copy-btn:hover { 
        background-color: #29a37a; 
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 #333;
    }
    .copy-btn:active {
        transform: translateY(1px);
        box-shadow: 1px 1px 0 #333;
    }
    .copy-btn.copied {
        background-color: #ff3333 !important;
        cursor: not-allowed;
        animation: wiggle 0.5s;
    }
    @keyframes wiggle {
        0%, 100% { transform: rotate(0); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 25px 0;
        padding: 15px;
        border-radius: 10px;
        border: 3px solid;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 3px 3px 0 #333;
    }
    .status.success { 
        background-color: #ccffcc; 
        color: #006600; 
        border-color: #33cc33;
    }
    .status.error { 
        background-color: #ffcccc; 
        color: #cc0000; 
        border-color: #ff3333;
    }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    .comic-dots {
        position: absolute;
        width: 20px;
        height: 20px;
        background: #ffcc00;
        border: 3px solid #333;
        border-radius: 50%;
    }
    .dot-1 { top: 20px; left: 20px; }
    .dot-2 { top: 20px; right: 20px; }
    .dot-3 { bottom: 20px; left: 20px; }
    .dot-4 { bottom: 20px; right: 20px; }
    .speech-bubble {
        position: absolute;
        bottom: -40px;
        right: 30px;
        background: white;
        border: 3px solid #333;
        border-radius: 20px;
        padding: 10px 15px;
        font-weight: bold;
        box-shadow: 3px 3px 0 #333;
        transform: rotate(-5deg);
        animation: float 3s infinite ease-in-out;
    }
    .speech-bubble:after {
        content: "";
        position: absolute;
        bottom: -15px;
        right: 30px;
        border-width: 15px 10px 0;
        border-style: solid;
        border-color: white transparent;
        display: block;
        width: 0;
    }
    .speech-bubble:before {
        content: "";
        position: absolute;
        bottom: -18px;
        right: 29px;
        border-width: 16px 11px 0;
        border-style: solid;
        border-color: #333 transparent;
        display: block;
        width: 0;
    }
    @keyframes float {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }
</style>
</head>
<body>
<div class="container">
    <div class="comic-dots dot-1"></div>
    <div class="comic-dots dot-2"></div>
    <div class="comic-dots dot-3"></div>
    <div class="comic-dots dot-4"></div>
    
    <h1>Survey Link Generator</h1>
    
    <div class="file-section">
        <h3>Upload Excel File</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls">
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
        <div class="speech-bubble">Click me!</div>
    </div>
    
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" data-link="${linkData.link}">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            // Add event listeners to all copy buttons
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    copyIndividualLink(this.getAttribute('data-link'), this);
                });
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(link, button) {
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = link;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            button.textContent = 'Copied!';
            button.classList.add('copied');
            setTimeout(() => {
                button.textContent = 'Copy';
                button.classList.remove('copied');
            }, 2000);
        } else {
            showStatus('Failed to copy link', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy link', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = links;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            showStatus('All links copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy all links', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy all links', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "survey_links.csv");
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showStatus('CSV exported successfully!', 'success');
}

// Clear all data
function clearData() {
    currentData = [];
    document.querySelector('#linkTable tbody').innerHTML = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('copyAllBtn').disabled = true;
    document.getElementById('exportBtn').disabled = true;
    document.getElementById('generateBtn').disabled = true;
    document.getElementById('status').style.display = 'none';
}

// Show status message
function showStatus(message, type) {
    const statusEl = document.getElementById('status');
    statusEl.textContent = message;
    statusEl.className = `status ${type}`;
    statusEl.style.display = 'block';
}

// Enable generate button when file is selected
document.getElementById('fileInput').addEventListener('change', function() {
    document.getElementById('generateBtn').disabled = !this.files.length;
});
</script>
</body>
</html>
Key Fixes Made:
Fixed Copy Functionality:

Replaced navigator.clipboard with document.execCommand('copy') for better browser compatibility

Added a temporary textarea element to handle copying

Added proper error handling for copy operations

Improved Event Handling:

Changed from inline onclick handlers to event listeners

Used data-link attributes to store the link data

This prevents issues with special characters in URLs

Maintained Comic Theme:

All the comic-style visuals remain intact

Same animations and styling

Same functionality

The copy functionality should now work reliably across all browsers. The comic theme with its bold colors, speech bubbles, and fun animations is preserved while ensuring the core functionality works properly.

If the link is copied once make unable to copy again
Survey Link Generator - Comic Theme with One-Time Copy
I've updated the code to disable the copy button after it's been clicked once, preventing multiple copies of the same link.

html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #e6f2ff;
        background-image: radial-gradient(#b3d9ff 15%, transparent 16%),
                          radial-gradient(#b3d9ff 15%, transparent 16%);
        background-size: 40px 40px;
        background-position: 0 0, 20px 20px;
        color: #333;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 8px 8px 0 #333, 15px 15px 0 #ffcc00;
        border: 4px solid #333;
        position: relative;
        overflow: hidden;
    }
    .container:before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border: 3px dashed #ff6600;
        border-radius: 20px;
        pointer-events: none;
        z-index: -1;
    }
    h1 {
        text-align: center;
        font-size: 36px;
        margin-bottom: 25px;
        color: #ff3300;
        text-shadow: 3px 3px 0 #ffcc00, 6px 6px 0 rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 30px;
        background: white;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
    }
    h1:after {
        content: "!!!";
        position: absolute;
        top: -20px;
        right: -20px;
        background: #ffcc00;
        color: #ff3300;
        font-size: 24px;
        padding: 5px 10px;
        border-radius: 50%;
        border: 3px solid #333;
        transform: rotate(15deg);
        animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
        from { transform: rotate(15deg) scale(1); }
        to { transform: rotate(15deg) scale(1.1); }
    }
    .file-section {
        text-align: center;
        margin: 25px 0;
        padding: 25px;
        border: 4px dashed #ff6600;
        border-radius: 15px;
        background-color: #fff9e6;
        position: relative;
    }
    .file-section:before {
        content: "üìÅ";
        position: absolute;
        top: -20px;
        left: 20px;
        font-size: 40px;
        background: white;
        padding: 5px;
        border: 3px solid #333;
        border-radius: 10px;
        transform: rotate(-10deg);
    }
    input[type="file"] {
        margin-top: 15px;
        padding: 10px;
        border: 3px solid #3399ff;
        border-radius: 10px;
        background: white;
        font-family: 'Comic Sans MS', sans-serif;
        font-size: 16px;
        cursor: pointer;
    }
    .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 12px 25px;
        border: 3px solid #333;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        transition: all 0.2s;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 4px 4px 0 #333;
    }
    .btn:hover {
        transform: translateY(-3px);
        box-shadow: 6px 6px 0 #333;
    }
    .btn:active {
        transform: translateY(1px);
        box-shadow: 2px 2px 0 #333;
    }
    .btn-primary { 
        background-color: #3399ff; 
        color: white; 
    }
    .btn-primary:hover { 
        background-color: #0077e6; 
    }
    .btn-success { 
        background-color: #33cc33; 
        color: white; 
    }
    .btn-success:hover { 
        background-color: #29a329; 
    }
    .btn-warning { 
        background-color: #ffcc00; 
        color: #333; 
    }
    .btn-warning:hover { 
        background-color: #e6b800; 
    }
    .btn:disabled { 
        background-color: #cccccc; 
        color: #999;
        cursor: not-allowed; 
        box-shadow: 2px 2px 0 #999;
        border-color: #999;
    }
    .btn:disabled:hover {
        transform: none;
        box-shadow: 2px 2px 0 #999;
    }
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-top: 25px;
        border: 4px solid #333;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    th, td {
        border-bottom: 3px solid #333;
        border-right: 3px solid #333;
        padding: 12px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
        font-size: 18px;
        text-transform: uppercase;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    th:last-child, td:last-child {
        border-right: none;
    }
    tr:last-child td {
        border-bottom: none;
    }
    tr:nth-child(even) { 
        background-color: #fff0e6; 
    }
    tr:nth-child(odd) { 
        background-color: white; 
    }
    .copy-btn {
        background-color: #33cc99;
        color: white;
        border: 2px solid #333;
        padding: 8px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        box-shadow: 2px 2px 0 #333;
        transition: all 0.2s;
    }
    .copy-btn:hover { 
        background-color: #29a37a; 
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 #333;
    }
    .copy-btn:active {
        transform: translateY(1px);
        box-shadow: 1px 1px 0 #333;
    }
    .copy-btn.copied {
        background-color: #ff3333 !important;
        cursor: not-allowed;
        animation: wiggle 0.5s;
    }
    .copy-btn:disabled {
        background-color: #999999 !important;
        color: #666;
        cursor: not-allowed;
        box-shadow: 1px 1px 0 #666;
        border-color: #666;
        transform: none;
    }
    @keyframes wiggle {
        0%, 100% { transform: rotate(0); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 25px 0;
        padding: 15px;
        border-radius: 10px;
        border: 3px solid;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 3px 3px 0 #333;
    }
    .status.success { 
        background-color: #ccffcc; 
        color: #006600; 
        border-color: #33cc33;
    }
    .status.error { 
        background-color: #ffcccc; 
        color: #cc0000; 
        border-color: #ff3333;
    }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    .comic-dots {
        position: absolute;
        width: 20px;
        height: 20px;
        background: #ffcc00;
        border: 3px solid #333;
        border-radius: 50%;
    }
    .dot-1 { top: 20px; left: 20px; }
    .dot-2 { top: 20px; right: 20px; }
    .dot-3 { bottom: 20px; left: 20px; }
    .dot-4 { bottom: 20px; right: 20px; }
    .speech-bubble {
        position: absolute;
        bottom: -40px;
        right: 30px;
        background: white;
        border: 3px solid #333;
        border-radius: 20px;
        padding: 10px 15px;
        font-weight: bold;
        box-shadow: 3px 3px 0 #333;
        transform: rotate(-5deg);
        animation: float 3s infinite ease-in-out;
    }
    .speech-bubble:after {
        content: "";
        position: absolute;
        bottom: -15px;
        right: 30px;
        border-width: 15px 10px 0;
        border-style: solid;
        border-color: white transparent;
        display: block;
        width: 0;
    }
    .speech-bubble:before {
        content: "";
        position: absolute;
        bottom: -18px;
        right: 29px;
        border-width: 16px 11px 0;
        border-style: solid;
        border-color: #333 transparent;
        display: block;
        width: 0;
    }
    @keyframes float {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }
</style>
</head>
<body>
<div class="container">
    <div class="comic-dots dot-1"></div>
    <div class="comic-dots dot-2"></div>
    <div class="comic-dots dot-3"></div>
    <div class="comic-dots dot-4"></div>
    
    <h1>Survey Link Generator</h1>
    
    <div class="file-section">
        <h3>Upload Excel File</h3>
        <input type="file" id="fileInput" accept=".xlsx, .xls">
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
        <div class="speech-bubble">Click me!</div>
    </div>
    
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link,
                        copied: false // Track if this link has been copied
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" data-index="${currentData.length - 1}">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            // Add event listeners to all copy buttons
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    copyIndividualLink(index, this);
                });
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(index, button) {
    const linkData = currentData[index];
    
    // If already copied, do nothing
    if (linkData.copied) {
        return;
    }
    
    const link = linkData.link;
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = link;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark as copied and disable the button
            linkData.copied = true;
            button.textContent = 'Copied!';
            button.classList.add('copied');
            button.disabled = true;
            
            showStatus('Link copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy link', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy link', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = links;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark all links as copied and disable all copy buttons
            currentData.forEach((item, index) => {
                item.copied = true;
            });
            
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                button.disabled = true;
            });
            
            showStatus('All links copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy all links', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy all links', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "survey_links.csv");
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showStatus('CSV exported successfully!', 'success');
}

// Clear all data
function clearData() {
    currentData = [];
    document.querySelector('#linkTable tbody').innerHTML = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('copyAllBtn').disabled = true;
    document.getElementById('exportBtn').disabled = true;
    document.getElementById('generateBtn').disabled = true;
    document.getElementById('status').style.display = 'none';
}

// Show status message
function showStatus(message, type) {
    const statusEl = document.getElementById('status');
    statusEl.textContent = message;
    statusEl.className = `status ${type}`;
    statusEl.style.display = 'block';
}

// Enable generate button when file is selected
document.getElementById('fileInput').addEventListener('change', function() {
    document.getElementById('generateBtn').disabled = !this.files.length;
});
</script>
</body>
</html>
Key Changes Made:
Added Copy Tracking:

Each link data object now has a copied property to track if it has been copied

When a link is copied, this property is set to true

Disabled Copy Button After Use:

After copying, the button text changes to "Copied!"

The button is disabled and cannot be clicked again

Visual styling changes to indicate it's no longer active

Updated Copy All Functionality:

When "Copy All Links" is clicked, all individual copy buttons are disabled

All links are marked as copied in the data

Enhanced Visual Feedback:

Disabled buttons have a gray appearance

Copied buttons show a clear "Copied!" message

The wiggle animation still plays when copying

Now each link can only be copied once, preventing duplicate copies of the same survey link. The comic theme is maintained with all its fun visual elements while adding this important functionality improvement.

Choose file is over lapping adjust in the frame
Survey Link Generator - Comic Theme (Fixed File Input)
I've fixed the file input overlapping issue by adjusting the styling and layout.

html
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Survey Link Generator</title>
<style>
    body {
        font-family: 'Comic Sans MS', 'Marker Felt', 'Arial Rounded MT Bold', sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #e6f2ff;
        background-image: radial-gradient(#b3d9ff 15%, transparent 16%),
                          radial-gradient(#b3d9ff 15%, transparent 16%);
        background-size: 40px 40px;
        background-position: 0 0, 20px 20px;
        color: #333;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 8px 8px 0 #333, 15px 15px 0 #ffcc00;
        border: 4px solid #333;
        position: relative;
        overflow: hidden;
    }
    .container:before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        border: 3px dashed #ff6600;
        border-radius: 20px;
        pointer-events: none;
        z-index: -1;
    }
    h1 {
        text-align: center;
        font-size: 36px;
        margin-bottom: 25px;
        color: #ff3300;
        text-shadow: 3px 3px 0 #ffcc00, 6px 6px 0 rgba(0,0,0,0.2);
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding: 10px 30px;
        background: white;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
    }
    h1:after {
        content: "!!!";
        position: absolute;
        top: -20px;
        right: -20px;
        background: #ffcc00;
        color: #ff3300;
        font-size: 24px;
        padding: 5px 10px;
        border-radius: 50%;
        border: 3px solid #333;
        transform: rotate(15deg);
        animation: bounce 1s infinite alternate;
    }
    @keyframes bounce {
        from { transform: rotate(15deg) scale(1); }
        to { transform: rotate(15deg) scale(1.1); }
    }
    .file-section {
        text-align: center;
        margin: 25px 0;
        padding: 25px;
        border: 4px dashed #ff6600;
        border-radius: 15px;
        background-color: #fff9e6;
        position: relative;
        min-height: 120px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    .file-section:before {
        content: "üìÅ";
        position: absolute;
        top: -20px;
        left: 20px;
        font-size: 40px;
        background: white;
        padding: 5px;
        border: 3px solid #333;
        border-radius: 10px;
        transform: rotate(-10deg);
    }
    .file-input-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        width: 100%;
        max-width: 400px;
    }
    .file-label {
        font-weight: bold;
        font-size: 18px;
        color: #333;
        background: #ffcc00;
        padding: 8px 15px;
        border-radius: 8px;
        border: 2px solid #333;
        box-shadow: 3px 3px 0 #333;
        cursor: pointer;
        transition: all 0.2s;
    }
    .file-label:hover {
        transform: translateY(-2px);
        box-shadow: 4px 4px 0 #333;
    }
    input[type="file"] {
        display: none;
    }
    .file-name {
        font-size: 16px;
        color: #666;
        background: white;
        padding: 8px 15px;
        border-radius: 8px;
        border: 2px solid #3399ff;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    .button-group {
        display: flex;
        gap: 15px;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
    }
    .btn {
        padding: 12px 25px;
        border: 3px solid #333;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        transition: all 0.2s;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 4px 4px 0 #333;
    }
    .btn:hover {
        transform: translateY(-3px);
        box-shadow: 6px 6px 0 #333;
    }
    .btn:active {
        transform: translateY(1px);
        box-shadow: 2px 2px 0 #333;
    }
    .btn-primary { 
        background-color: #3399ff; 
        color: white; 
    }
    .btn-primary:hover { 
        background-color: #0077e6; 
    }
    .btn-success { 
        background-color: #33cc33; 
        color: white; 
    }
    .btn-success:hover { 
        background-color: #29a329; 
    }
    .btn-warning { 
        background-color: #ffcc00; 
        color: #333; 
    }
    .btn-warning:hover { 
        background-color: #e6b800; 
    }
    .btn:disabled { 
        background-color: #cccccc; 
        color: #999;
        cursor: not-allowed; 
        box-shadow: 2px 2px 0 #999;
        border-color: #999;
    }
    .btn:disabled:hover {
        transform: none;
        box-shadow: 2px 2px 0 #999;
    }
    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin-top: 25px;
        border: 4px solid #333;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    th, td {
        border-bottom: 3px solid #333;
        border-right: 3px solid #333;
        padding: 12px;
        text-align: left;
        vertical-align: middle;
    }
    th {
        background-color: #ff6600;
        color: white;
        position: sticky;
        top: 0;
        font-size: 18px;
        text-transform: uppercase;
        text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    th:last-child, td:last-child {
        border-right: none;
    }
    tr:last-child td {
        border-bottom: none;
    }
    tr:nth-child(even) { 
        background-color: #fff0e6; 
    }
    tr:nth-child(odd) { 
        background-color: white; 
    }
    .copy-btn {
        background-color: #33cc99;
        color: white;
        border: 2px solid #333;
        padding: 8px 15px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        font-family: 'Comic Sans MS', sans-serif;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        box-shadow: 2px 2px 0 #333;
        transition: all 0.2s;
    }
    .copy-btn:hover { 
        background-color: #29a37a; 
        transform: translateY(-2px);
        box-shadow: 3px 3px 0 #333;
    }
    .copy-btn:active {
        transform: translateY(1px);
        box-shadow: 1px 1px 0 #333;
    }
    .copy-btn.copied {
        background-color: #ff3333 !important;
        cursor: not-allowed;
        animation: wiggle 0.5s;
    }
    .copy-btn:disabled {
        background-color: #999999 !important;
        color: #666;
        cursor: not-allowed;
        box-shadow: 1px 1px 0 #666;
        border-color: #666;
        transform: none;
    }
    @keyframes wiggle {
        0%, 100% { transform: rotate(0); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
    }
    /* Hide Survey Model and Generated Link columns visually */
    th:nth-child(3), td:nth-child(3),
    th:nth-child(4), td:nth-child(4) {
        display: none;
    }
    .status {
        text-align: center;
        margin: 25px 0;
        padding: 15px;
        border-radius: 10px;
        border: 3px solid;
        font-weight: bold;
        font-size: 18px;
        box-shadow: 3px 3px 0 #333;
    }
    .status.success { 
        background-color: #ccffcc; 
        color: #006600; 
        border-color: #33cc33;
    }
    .status.error { 
        background-color: #ffcccc; 
        color: #cc0000; 
        border-color: #ff3333;
    }
    .table-container {
        max-height: 600px;
        overflow-y: auto;
        border: 4px solid #333;
        border-radius: 15px;
        box-shadow: 5px 5px 0 #333;
        background: white;
    }
    .comic-dots {
        position: absolute;
        width: 20px;
        height: 20px;
        background: #ffcc00;
        border: 3px solid #333;
        border-radius: 50%;
    }
    .dot-1 { top: 20px; left: 20px; }
    .dot-2 { top: 20px; right: 20px; }
    .dot-3 { bottom: 20px; left: 20px; }
    .dot-4 { bottom: 20px; right: 20px; }
    .speech-bubble {
        position: absolute;
        bottom: -40px;
        right: 30px;
        background: white;
        border: 3px solid #333;
        border-radius: 20px;
        padding: 10px 15px;
        font-weight: bold;
        box-shadow: 3px 3px 0 #333;
        transform: rotate(-5deg);
        animation: float 3s infinite ease-in-out;
    }
    .speech-bubble:after {
        content: "";
        position: absolute;
        bottom: -15px;
        right: 30px;
        border-width: 15px 10px 0;
        border-style: solid;
        border-color: white transparent;
        display: block;
        width: 0;
    }
    .speech-bubble:before {
        content: "";
        position: absolute;
        bottom: -18px;
        right: 29px;
        border-width: 16px 11px 0;
        border-style: solid;
        border-color: #333 transparent;
        display: block;
        width: 0;
    }
    @keyframes float {
        0%, 100% { transform: rotate(-5deg) translateY(0); }
        50% { transform: rotate(-5deg) translateY(-5px); }
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .container {
            padding: 15px;
        }
        h1 {
            font-size: 28px;
            padding: 8px 20px;
        }
        .file-section {
            padding: 20px 15px;
        }
        .button-group {
            flex-direction: column;
            align-items: center;
        }
        .btn {
            width: 100%;
            max-width: 300px;
        }
        table {
            font-size: 14px;
        }
        th, td {
            padding: 8px;
        }
    }
</style>
</head>
<body>
<div class="container">
    <div class="comic-dots dot-1"></div>
    <div class="comic-dots dot-2"></div>
    <div class="comic-dots dot-3"></div>
    <div class="comic-dots dot-4"></div>
    
    <h1>Survey Link Generator</h1>
    
    <div class="file-section">
        <div class="file-input-container">
            <label for="fileInput" class="file-label">üìÅ CHOOSE EXCEL FILE</label>
            <input type="file" id="fileInput" accept=".xlsx, .xls">
            <div class="file-name" id="fileName">No file chosen</div>
        </div>
        <div class="button-group">
            <button class="btn btn-primary" id="generateBtn" onclick="processFile()" disabled>Generate Links</button>
            <button class="btn btn-warning" onclick="clearData()">Clear All</button>
        </div>
    </div>
    
    <div id="status" class="status" style="display: none;"></div>
    
    <div class="button-group">
        <button class="btn btn-success" id="copyAllBtn" onclick="copyAllLinks()" disabled>Copy All Links</button>
        <button class="btn btn-primary" onclick="exportToCSV()" id="exportBtn" disabled>Export to CSV</button>
        <div class="speech-bubble">Click me!</div>
    </div>
    
    <div class="table-container">
        <table id="linkTable">
            <thead>
                <tr>
                    <th>Receipt No.</th>
                    <th>Sales Type</th>
                    <th>Survey Model</th>
                    <th>Generated Link</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let currentData = [];
const storeID = "91KDIPL879-01"; // Store Code

// Excel date/time converters
function convertExcelDate(serial) {
    const date = new Date((serial - 25569) * 86400 * 1000);
    return `${date.getFullYear()}-${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')}`;
}
function convertExcelTime(serial) {
    const totalMilliseconds = Math.round(serial * 24 * 60 * 60 * 1000);
    const hours = String(Math.floor(totalMilliseconds / (60 * 60 * 1000))).padStart(2,'0');
    const minutes = String(Math.floor((totalMilliseconds % (60 * 60 * 1000)) / (60 * 1000))).padStart(2,'0');
    const seconds = String(Math.floor((totalMilliseconds % (60 * 1000)) / 1000)).padStart(2,'0');
    const milliseconds = String(totalMilliseconds % 1000).padStart(3,'0');
    return `${hours}:${minutes}:${seconds}.${milliseconds}`;
}

// Generate link
function generateSurveyLink(row) {
    const receiptNo = row['Receipt No.'];
    const salesType = row['Sales Type'];
    let surveyModel = '', orderID = '', numericOT = '';

    if (/^\d+$/.test(receiptNo) && salesType === 'TAKEAWAY') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '2'; }
    else if (/^\d+$/.test(receiptNo) && salesType === 'DINE-IN') { surveyModel = '6.0'; orderID = receiptNo; numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'TAKEAWAY') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '2'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DINE-IN') { surveyModel = '4.0'; orderID = receiptNo.slice(-4); numericOT = '1'; }
    else if (receiptNo.startsWith('K281') && salesType === 'DELIVERY') { surveyModel = '3.0'; orderID = receiptNo; numericOT = '3'; }
    else { return null; }

    const date = convertExcelDate(row['Date']);
    const time = convertExcelTime(row['Time']);
    const phoneNumber = `91${row['Sell-to Contact No.']}`;
    const isoDateTime = `${date}T${time}Z`;

    const data = { "S": storeID, "OI": orderID, "D": date, "TM": time, "DTM": isoDateTime, "TI": orderID, "OT": numericOT, "SM": surveyModel, "PH": phoneNumber };
    const encodedData = btoa(JSON.stringify(data));
    return `https://customer.kfc-listens.com/jfe/form/SV_8bHC0noyvM3jPWC?Q_EED=${encodedData}`;
}

// File processing
function processFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return showStatus('Please select a file first', 'error');
    showStatus('Processing file...', 'success');

    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const workbook = XLSX.read(new Uint8Array(e.target.result), { type: 'array' });
            const sheetData = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            const filteredData = sheetData.filter(row => !(row['POS Receipt No.']||'').match(/K281SWG|K281ZMT|K281MAGIC/));

            currentData = [];
            const tbody = document.querySelector('#linkTable tbody');
            tbody.innerHTML = '';

            let processedCount = 0;
            filteredData.forEach((row, index) => {
                const link = generateSurveyLink(row);
                if (link) {
                    processedCount++;
                    const linkData = {
                        receiptNo: row['Receipt No.'],
                        salesType: row['Sales Type'],
                        surveyModel: link.includes('SM=6.0') ? '6.0' : link.includes('SM=4.0') ? '4.0' : link.includes('SM=3.0') ? '3.0' : 'Unknown',
                        link: link,
                        copied: false // Track if this link has been copied
                    };
                    currentData.push(linkData);

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${linkData.receiptNo}</td>
                        <td>${linkData.salesType}</td>
                        <td>${linkData.surveyModel}</td>
                        <td>${linkData.link}</td>
                        <td><button class="copy-btn" data-index="${currentData.length - 1}">Copy</button></td>
                    `;
                    tbody.appendChild(tr);
                }
            });

            // Add event listeners to all copy buttons
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    copyIndividualLink(index, this);
                });
            });

            showStatus(`Processed ${processedCount} records`, 'success');
            document.getElementById('copyAllBtn').disabled = false;
            document.getElementById('exportBtn').disabled = false;
        } catch (err) {
            showStatus('Error: ' + err.message, 'error');
        }
    };
    reader.readAsArrayBuffer(file);
}

// Copy individual link
function copyIndividualLink(index, button) {
    const linkData = currentData[index];
    
    // If already copied, do nothing
    if (linkData.copied) {
        return;
    }
    
    const link = linkData.link;
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = link;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark as copied and disable the button
            linkData.copied = true;
            button.textContent = 'Copied!';
            button.classList.add('copied');
            button.disabled = true;
            
            showStatus('Link copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy link', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy link', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Copy all links
function copyAllLinks() {
    const links = currentData.map(item => item.link).join('\n');
    
    // Create a temporary textarea element
    const textArea = document.createElement("textarea");
    textArea.value = links;
    textArea.style.position = "fixed";
    textArea.style.left = "-999999px";
    textArea.style.top = "-999999px";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            // Mark all links as copied and disable all copy buttons
            currentData.forEach((item, index) => {
                item.copied = true;
            });
            
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                button.disabled = true;
            });
            
            showStatus('All links copied to clipboard!', 'success');
        } else {
            showStatus('Failed to copy all links', 'error');
        }
    } catch (err) {
        console.error('Fallback: Oops, unable to copy', err);
        showStatus('Failed to copy all links', 'error');
    }
    
    document.body.removeChild(textArea);
}

// Export to CSV
function exportToCSV() {
    if (currentData.length === 0) return showStatus('No data to export', 'error');
    
    let csvContent = "Receipt No.,Sales Type,Survey Model,Generated Link\n";
    currentData.forEach(row => {
        csvContent += `"${row.receiptNo}","${row.salesType}","${row.surveyModel}","${row.link}"\n`;
    });
    
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", "survey_links.csv");
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showStatus('CSV exported successfully!', 'success');
}

// Clear all data
function clearData() {
    currentData = [];
    document.querySelector('#linkTable tbody').innerHTML = '';
    document.getElementById('fileInput').value = '';
    document.getElementById('fileName').textContent = 'No file chosen';
    document.getElementById('copyAllBtn').disabled = true;
    document.getElementById('exportBtn').disabled = true;
    document.getElementById('generateBtn').disabled = true;
    document.getElementById('status').style.display = 'none';
}

// Show status message
function showStatus(message, type) {
    const statusEl = document.getElementById('status');
    statusEl.textContent = message;
    statusEl.className = `status ${type}`;
    statusEl.style.display = 'block';
}

// Enable generate button when file is selected and show file name
document.getElementById('fileInput').addEventListener('change', function() {
    const fileName = this.files.length > 0 ? this.files[0].name : 'No file chosen';
    document.getElementById('fileName').textContent = fileName;
    document.getElementById('generateBtn').disabled = !this.files.length;
});
</script>
</body>
</html>
